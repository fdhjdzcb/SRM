<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${title}"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <base href="/">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="" th:href="@{/css/Buttons.css}"/>
    <link rel="stylesheet" href="" th:href="@{/css/Sidebar.css}"/>
    <script src="https://yastatic.net/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" th:src="@{/js/sideBar.js}"></script>
</head>
<body>
<div th:insert="blocks/SRMmenu :: srmmenu"></div>
<div class="text-center p-2"><h1>Опубликовать новость</h1></div>

<form class="container needs-validation p-8" style="width: 35%" th:action="@{/srm/create_news}" method="post">
    <!--novalidate=""-->
    <div class="row g-3">
        <div class="col-12">
            <label for="new_title" class="form-label">Заголовок</label>
            <input type="text" class="form-control" id="new_title" name="new_title" placeholder="Заголовок"
                   required="" maxlength="50">
        </div>

        <div class="col-12">
            <label for="new_text" class="form-label">Текст новости</label>
            <textarea class="form-control" id="new_text" name="new_text" placeholder="Текст новости"
                      required="" maxlength="300"></textarea>
        </div>

        <div>
            <p class="form-label">Изображение, до 4МБ</p>
            <!--<input type="file" accept="image/*"  class="form-control" id="new_image" name="new_image">-->

            <input type="file" onchange="previewFile()" accept="image/*"  class="form-control" name="new_image"><br>
            <textarea hidden id="b64" rows="13" cols="40"></textarea>
            <img src="" height="200" alt="Предпросмотр">
        </div>
    </div>

    <hr class="my-4">

    <button class="create" type="submit">Опубликовать</button>
</form>


<script>
    var uploadField = document.getElementById("new_image");
    uploadField.onchange = function () {
        if (this.files[0].size > 4194304) {
            alert("Слишком большой файл!");
            this.value = "";
        }
    };
</script>
<script>
    function previewFile() {
    const preview = document.querySelector('img');
    const file = document.querySelector('input[type=file]').files[0];
    const reader = new FileReader();

    reader.addEventListener("load", function () {
        // convert image file to base64 string
        preview.src = reader.result;
        b64.innerHTML = reader.result; // show in textarea
    }, false);

    if (file) {
        reader.readAsDataURL(file);
    }
}</script>
<div th:insert="blocks/scripts_footer :: scripts_footer"></div>
</body>
</html>